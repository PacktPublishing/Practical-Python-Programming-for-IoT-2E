{% args gpio %}
<!-- 
    The above {% args gpio %} is required by the utemplate engine used by Microdot,
    and it must be the first line in the file.
    
    It defines the arguments used in the page. If it is missing you will receive
    the error "NameError: name 'gpio' isn't defined" on the terminal console as you load
    this page in a browser.

    In microdot_server_pico.py the following code snippet is where the gpio argument is passed to this page:
    
    async def index(request):
        return Template('index_ws_client.html').render(gpio=LED_GPIO), {'Content-Type': 'text/html'}
-->
<!DOCTYPE html>
<html>
<head>
    <title>Microdot Web Socket Example</title>
    <script src="/static/jquery.min.js"></script>
    <script src="/static/socket.io.js"></script>                            <!-- (1) -->
    <script type="text/javascript">

        var socket = io();  // For API documentation see https://socket.io    // (2)

        socket.on('connect', function() {                                     // (3)
            console.log("Connected to Server");
            $("#connected").html("Yes");
        });

        socket.on('disconnect', function() {                                  // (4)
            console.log("Disconnected from the Server");
            $("#connected").html("No");
        });

        socket.on('led', function(dataFromServer) {                           // (5)
            console.log(dataFromServer)
            if (dataFromServer.level !== undefined) {
                $("input[type=range].brightnessLevel").val(dataFromServer.level);
                $("#brightnessLevel").html(dataFromServer.level);
            }
        });

        $(document).ready(function() {                                        // (6)
            // Event listener for Slider value changes.
            $("input[type=range].brightnessLevel").on('input', function(){
                level = $(this).val();
                payload = {"level": level};
                socket.emit('led', payload);
            });
        });
    </script>
</head>
<body>
    <h1>Microdot Web Socket Example</h1>
    LED is connected to GPIO {{gpio}}<br>
    Connected to server: <span id="connected">No</span>                     <!-- (7) -->
    <br><br>
    Brightness <span id="brightnessLevel"></span>:<br>
    <input type="range" min="0" max="100" value="0" class="brightnessLevel">
</body>
</html>